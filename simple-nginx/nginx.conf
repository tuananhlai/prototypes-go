# --- Global Context ---
# Settings here affect the entire Nginx instance.

# Defines the Linux user and group that the worker processes will run as.
# user  nobody nobody;             

# The number of worker processes. 'auto' is often used to match CPU cores.
worker_processes  1;               

# Defines the location and logging level of the error log.
# error_log  logs/error.log  error; 

# Defines the file that stores the process ID of the main process.
# pid        logs/nginx.pid;

events {
    # Maximum number of simultaneous connections that can be opened by a worker process.
    worker_connections  512;       

    # Specifies the connection processing method to use (epoll is most efficient for Linux).
    # use epoll;      

    # If enabled, worker processes will accept new connections one by one. 
    accept_mutex       off;        

    # If enabled, a worker process will accept all new connections at a time.
    multi_accept       off;        
}

# --- HTTP Context ---
# Configuration for handling HTTP/HTTPS traffic.

http {
    # Includes the file mapping file extensions to MIME types of responses.
    include       mime.types;

    # The default type of response if the type cannot be determined from mime.types.
    default_type  text/plain;      

    # Standard log format for tracking requests.
    # log_format combined '$remote_addr - $remote_user [$time_local] '
    #                     '"$request" $status $body_bytes_sent '
    #                     '"$http_referer" "$http_user_agent"';

    # Enables or disables the use of sendfile() to copy data between file descriptors.
    sendfile            off;       

    # Only used if sendfile is 'on'. Sends the response header and the beginning 
    # of a file in one packet.
    tcp_nopush          off;       

    # Enables or disables the use of the TCP_NODELAY option (disables Nagle's algorithm).
    tcp_nodelay         on;        

    # Timeout during which a keep-alive client connection will stay open on the server side.
    keepalive_timeout   75s;       

    # The maximum number of requests that can be served through one keep-alive connection.
    keepalive_requests  1000;      
    
    # Sets the maximum allowed size of the client request body (e.g., for file uploads).
    client_max_body_size      1m;  

    # Buffer size for reading client request body.
    client_body_buffer_size   8k;  

    # Enables or disables compression of responses using gzip.
    gzip              off;         

    # Sets the minimum length of a response that will be gzipped.
    gzip_min_length   20;          

    # --- Server Context ---
    # Defines a virtual server.

    server {
        # The IP address and port on which the server will accept requests.
        listen       80;           

        # Sets names of a virtual server.
        server_name  "";           
        
        # Configuration for a specific URI or set of URIs.
        location / {
            # Sets the root directory for requests.
            root   html;           

            # Defines files that will be used as an index.
            index  index.html;     
        }

        # Redirects specific error codes to a designated page.
        error_page   500 502 503 504  /50x.html;
        location = /50x.html {
            root   html;
        }
    }
}